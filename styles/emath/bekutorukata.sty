% bekutorukata.sty by tDB(emath@nifty.com)
%
\ProvidesPackage{bekutorukata}[2008/09/09 v0.04]%
%
\RequirePackage{emath}%
%
\newcommand{\bekutoru@overrightarrow}{%
  \mathpalette{\overarrow@\bekutoru@rightarrowfill@}}
\def\bekutoru@rightarrowfill@{%
  \arrowfill@\bekutoru@relbar\bekutoru@relbar\bekutoru@rightarrow}
\def\bekutoru@t#1{\ensuremath{\displaystyle
  \bekutoru@overrightarrow{\text{#1}\bekutoru@sityuu}}}%
\def\bekutoru@m#1{\ensuremath{\displaystyle%\,%
  \bekutoru@overrightarrow{#1\,\bekutoru@sityuu}}}%
\let\cmbekutoru\bekutoru
%
\def\ArrowHeadPit{0}%
\let\mybekutoru\relax
\def\bekutorukata{\@ifnextchar<{\@bekutorukata}{\@bekutorukata<\ArrowHeadPit>}}%
\def\@bekutorukata<#1>{\edef\bekutoru@kubomi{#1}\@@bekutorukata}%
\def\@@bekutorukata#1{%
  \ifthenelse{\equal{#1}{cm}}%
  {\bekutorusityuu{\vrule height .9zh width \z@}%
    \let\bekutoru@relbar\relbar\let\bekutoru@rightarrow\rightarrow
    \let\bekutoru\cmbekutoru}%
  {%
    \ifthenelse{\equal{#1}{eu}}%
    {\bekutorusityuu{\vrule height .85zh width \z@}%
      \let\bekutoru@relbar\relbar\let\bekutoru@rightarrow\eurightarrow
      \let\bekutoru\cmbekutoru}%
    {%
      \ifthenelse{\equal{#1}{tx}}%
      {\bekutorusityuu{\vrule height .75zh width \z@}%
        \let\bekutoru@relbar\txrelbar\let\bekutoru@rightarrow\txrightarrow
        \let\bekutoru\cmbekutoru}%
      {%
        \ifthenelse{\equal{#1}{xy}}%
        {%
          \@ifundefined{xybekutoru}{}{%
%           \let\bekutoru@relbar\relbar\let\bekutoru@rightarrow\xyrightarrow
            \bekutorusityuu{\vrule height .9zh width \z@}%
            \let\bekutoru\xybekutoru
          }%
        }%
        {%
          \ifthenelse{\equal{#1}{px}}%
          {%
            \bekutorusityuu{\vrule height .75zh width \z@}%
            \let\bekutoru@relbar\pxrelbar\let\bekutoru@rightarrow\pxrightarrow
            \let\bekutoru\cmbekutoru
          }%
          {%
            \ifthenelse{\equal{#1}{abx}}%
            {%
              \bekutorusityuu{\vrule height .75zh width \z@}%
              \let\bekutoru@relbar\abxrelbar
              \let\bekutoru@rightarrow\abxrightarrow
              \let\bekutoru\cmbekutoru
            }%
            {%
              \ifthenelse{\equal{#1}{fill}}%
              {%
                \bekutorusityuu{\vrule height .9zh width \z@}%
                \def\bekutoru@t##1{{%
                  \@tempdima=1zh\relax
                  \edef\BK@hi{\strip@pt\@tempdima}%
                  \Div\BK@hi{9.16443}\BK@hi
                  \Mul{0.5}\BK@hi\BK@thickness
                  \changeArrowHeadSize\BK@hi
                  \setbox0=\hbox{\EMvphantom*[.5pt][0pt]{##1}\bekutoru@sityuu}%
                  \ukansan{\the\ht0}\bekutoru@h
%                 \setbox0=\hbox{##1}%
                  \ukansan{\the\wd0}\bekutoru@w
                  \begin{picture}(0,0)\relax
  \@ifundefined{xunitlength}{}{\xunitlength=\unitlength\def\@xscale{1}}%
  \@ifundefined{yunitlength}{}{\yunitlength=\unitlength\def\@yscale{1}}%
                    \edef\O@@{(0,0)}%
                    \edef\ArrowHeadPit{\bekutoru@kubomi}%
                    \DegSin\ArrowHeadAngle\bekutoru@s
                    \Mul\Arr@wHeadSize\bekutoru@s\bekutoru@s
                    \Addself\bekutoru@h\bekutoru@s
                    \allinethickness{\BK@thickness pt}%
\mybekutoru
                    \put(0,\bekutoru@h){\ArrowLine{(0,0)}{(\bekutoru@w,0)}}%
                    \Addself\bekutoru@h\bekutoru@s
                    \xdef\bekutoru@H{\bekutoru@h}%
                  \end{picture}%
                  \vrule width \z@ height \bekutoru@H \p@\box0
                }}%
                \def\bekutoru@m##1{{%
                  \@tempdima=1zh\relax
                  \edef\BK@hi{\strip@pt\@tempdima}%
                  \Div\BK@hi{9.16443}\BK@hi
                  \Mul{0.5}\BK@hi\BK@thickness
                  \changeArrowHeadSize\BK@hi
%                  \setbox0=\hbox{\bekutoru@sityuu}%
                  \setbox0=\hbox{\EMvphantom*[.5pt][0pt]{\ensuremath{\displaystyle ##1}}\bekutoru@sityuu}%
                  \ukansan{\the\ht0}\bekutoru@h
%                  \setbox0=\hbox{\ensuremath{\displaystyle ##1}}%
                  \ukansan{\the\wd0}\bekutoru@w
                  \begin{picture}(0,0)\relax
  \@ifundefined{xunitlength}{}{\xunitlength=\unitlength\def\@xscale{1}}%
  \@ifundefined{yunitlength}{}{\yunitlength=\unitlength\def\@yscale{1}}%
                    \edef\ArrowHeadPit{\bekutoru@kubomi}%
                    \DegSin\ArrowHeadAngle\bekutoru@s
                    \Mul\Arr@wHeadSize\bekutoru@s\bekutoru@s
                    \Addself\bekutoru@h\bekutoru@s
                    \allinethickness{\BK@thickness pt}%
\mybekutoru
                    \put(0,\bekutoru@h){\ArrowLine{(0,0)}{(\bekutoru@w,0)}}%
                    \Addself\bekutoru@h\bekutoru@s
                    \xdef\bekutoru@H{\bekutoru@h}%
                  \end{picture}%
                  \vrule width \z@ height \bekutoru@H \p@\box0
                }}%
              }%
              {%
                \ifthenelse{\equal{#1}{ceo}}{%
                  \bekutorusityuu{\vphantom{h}}%
                  \def\ceobekutoru##1{\ensuremath{%
                      \ceooverrightarrow{\vphantom{h}\text{##1}}}}%
                  \let\bekutoru\ceobekutoru
                  \let\vec\ceovec
                }{%
                  \ifthenelse{\equal{#1}{esvect}}{%
                    \bekutorusityuu{\vphantom{P}}%
                    \DeclareSymbolFont{esvector}     {U}{esvect}{m}{n}
                    \@ifundefined{fldr}{%
                      \DeclareMathSymbol{\fldr}{\mathrel}{esvector}{'024}%default
                    }{}%
                    \DeclareMathSymbol{\montraita}{\mathrel}{esvector}{'040}
                    \DeclareMathSymbol{\montraitd}{\mathrel}{esvector}{'043}
                    \def\relbareda{\mathrel{\mathpalette\mathsm@sh\montraita}}
                    \def\relbaredd{\mathrel{\mathpalette\mathsm@sh\montraitd}}
                    \def\vv{\@ifstar{\vvstar}{\vecteur}}
                    \def\vvstar##1##2{\vecteur{##1}_{\mkern-1mu\relax##2}}
                    \def\vecteur{%
                      \mathpalette{\overvect@\vectfill@}}
                    \def\vectfill@{\traitfill@\relbaredd\relbareda\fldr}
                    \def\traitfill@##1##2##3##4{%
                       $\m@th\mkern2mu\relax##4##1\mkern-1.5mu%
                       \cleaders\hbox{$##4\mkern0mu##2\mkern0mu$}\hfill
                       \mkern-1.5mu##3$%
                    }
                    \def\overvect@##1##2##3{\vbox{\ialign{####\crcr%
                     \noalign{\kern-.7pt\nointerlineskip}##1##2\crcr%
                     \noalign{\kern-.3pt\nointerlineskip}$\m@th\hfil##2##3\hfil$\crcr}}}
                    \let\bekutoru@relbar\relbaredd
                    \let\bekutoru@rightarrow\fldr
                    \let\overrightarrow\vv
                  }{%
                    \relax
                  }%
                }%
              }%
            }%
          }%
        }%
      }%
    }%
  }%
}
\bekutorukata{cm}%
\endinput
%
v 0.01 2006/10/22 \bekutorukata{esvect}
v 0.02 2007/06/28 \bekutorukata{fill}の場合の支柱調整
v 0.04 2008/09/09 emath.sty を読み込んでおく。
